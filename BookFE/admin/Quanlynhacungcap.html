<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý nhà cung cấp</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../CSS/home.css">
    <link rel="stylesheet" href="../CSS/QuanLySach.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" />
    <script src="../JS/angular.min.js"></script>
    <script src="../JS/home.js"></script>
    <script src="../JS/homepage_sanpham.js"></script>
    <script src="../JS/ProductED.js"></script>
</head>

<body ng-app="AppBanSach" ng-controller="HomeCtrl">
    <div id="frame">
        <div id="header-page">
            <div id="header-left">
                <span>ADMIN</span>
                <a class="log-out" href="./login.html"><i
                        class="fa-solid fa-arrow-right-from-bracket">&nbsp;&nbsp;</i>Đăng Xuất</a>
            </div>
            <div id="header-right">
                <b class="title">HỆ THỐNG QUẢN TRỊ NỘI DUNG</b>
            </div>
        </div>
        <div id="content-page">
            <div class="menu">
                <nav>
                    <ul>
                        <li><a id="menucategory" class="link" href="./home.html">Menu</a></li>
                        <li>
                            <a href="Quanlyhoadonban.html">
                                <div class="link" href="#">Hóa đơn bán</div>
                            </a>
                            <a href="pageProduct.html">
                                <div class="link" href="#">Khách hàng</div>
                            </a>
                            <a href="pageProduct.html">
                                <div class="link" href="#">Hóa đơn nhập</div>
                            </a>
                            <a href="Quanlynhacungcap.html">
                                <div class="link" href="#">Nhà cung cấp</div>
                            </a>
                            <a href="Quanlyloaisach.html">
                                <div class="link" href="#">Thể loại</div>
                            </a>
                            <a href="Quanlysach.html">
                                <div class="link" href="#">Sách</div>
                            </a>
                            <a href="pageProduct.html">
                                <div class="link" href="#">Tác giả</div>
                            </a>
                            <a href="pageProduct.html">
                                <div class="link" href="#">Người dùng</div>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
            <div class="product">
                <h2> <i class="fa-solid fa-circle-arrow-right"
                        style="font-size: 30px; color: blue; margin-top: 10px;"></i>&nbsp;&nbsp;QUẢN LÝ SẢN PHẨM</h2>
                <!-- <button class="add">THÊM MỚI</button>
                <button class="delete">XÓA NHIỀU</button> -->
            </div>
            <div style="float: left; width: 45%;margin-top: 18px;">
                <form>
                    <div class="col-12 col-s-12 padding-box">
                        <label for="txtright">Mã nhà cung cấp:</label>
                    </div>
                    <div class="col-12 col-s-12 padding-box">
                        <input type="text" id="mancc" placeholder="Nhập mã nhà cung cấp..Tự động sinh nếu không nhập..."
                            ng-model="newProduct.mancc">
                    </div>
                    <div class="col-12 col-s-12 padding-box">
                        <label for="txtright">Tên nhà cung cấp:</label>
                    </div>
                    <div class="col-12 col-s-12 padding-box">
                        <input type="text" id="tenncc" placeholder="Nhập tên nhà cung cấp..." ng-model="newProduct.tenncc">
                    </div>
                    <div class="col-12 col-s-12 padding-box">
                        <label for="txtright">Số điện thoại:</label>
                    </div>
                    <div class="col-12 col-s-12 padding-box">
                        <input type="text" id="sdtncc" placeholder="Nhập tên số điện thoại..." ng-model="newProduct.sdtncc">
                    </div>
                    <div class="col-12 col-s-12 padding-box">
                        <label for="txtright">Email:</label>
                    </div>
                    <div class="col-12 col-s-12 padding-box">
                        <input type="text" id="emailncc" placeholder="Nhập email..." ng-model="newProduct.emailncc">
                    </div>
                    <div class="col-12 col-s-12 padding-box">
                        <label for="txtright">Địa chỉ:</label>
                    </div>
                    <div class="col-12 col-s-12 padding-box">
                        <input type="text" id="diachincc" placeholder="Nhập địa chỉ..." ng-model="newProduct.diachincc">
                    </div>
                </form>
                </form>
                <hr>
                <script>
                </script>
                <button class="btn-form" style="background-color: rgba(44, 140, 15, 0.8);" onclick="ThemNCC()">Thêm
                    sản phẩm</button>
                <!-- <button class="btn-form" style="background-color: rgba(44, 140, 15, 0.8);" ng-click="ApiThemSach()">Thêm
                    sản phẩm</button> -->
                <button class="btn-form" style="background-color: rgba(227, 32, 21, 0.8);">Nhập
                    mới</button>
                <button class="btn-form" style="background-color: rgba(14, 87, 224, 0.8);" id="btnUpdate"
                    onclick="CapNhat()">Cập nhật thông tin</button>
            </div>
            <div class="padding-box" style="width: 45%; float: left;">
                <button class="add">THÊM MỚI</button>
                <button class="delete" onclick="XoaNCCAll()">XÓA NHIỀU</button>
                <table id="tb_sach" style="width: 100%; border-collapse: collapse; border-color: #fff ;float: left;">
                    <thead>
                        <tr>
                            <th class="checkboxx"><input type="checkbox" name="check" id="check"
                                    onclick="CheckAll(this)"></th>
                            <th class="mahd">Mã Nhà cung cấp</th>
                            <th class="mancc">Tên nhà cung cấp</th>
                            <th class="tensach">Số điện thoại</th>
                            <th class="edit">Email</th>
                            <th class="edit">Địa chỉ</th>
                            <th class="edit">Tools</th>
                        </tr>
                    </thead>
                    <tbody id="listCategorys"></tbody>
                    <!-- API -->
                    <!-- <tr ng-repeat="y in listItem" ng-click="selectRow(y)">
                        <td class="le"><input type="checkbox" name="check_all" id="check"></td>
                        <td class="le">{{y.maSach}}</td>
                        <td class="le">{{y.tenncc}}</td>
                        <td class="le">{{y.tenSach}}</td>
                        <td class="le">{{y.gia}}</td>
                        <td class="le">{{y.soLuong}}</td>
                        <td class="le">{{y.tacGia}}</td>
                        <td class="le" id="bc">{{y.bookCover}} </td>
                        <td class="le">
                            <button ng-click="ApiSuaSach(y.maSach)"><i class="fa-regular fa-pen-to-square" title="Sửa"></i></button>
                            <button ng-click="ApiXoaSach(y.maSach)"><i class="fa-regular fa-trash-can" ></i></button>
                        </td>
                    </tr> -->
                </table>
            </div>
            <hr>
            <div class="number-page">
                <a href="">1</a>
                <a href="">2</a>
                <a href="">3</a>
                <a href="">4</a>
                <a href="">5</a>
                <a href="">6</a>
                <a href="">7</a>
                <a href="">8</a>
                <a href="">9</a>
            </div>
        </div>
    </div>
    <script>
        var list = JSON.parse(localStorage.getItem("Supplier")) || [];
        function loadFile(event) {
            var image = document.getElementById('viewimg');
            image.src = URL.createObjectURL(event.target.files[0]);
        }

        function ThemNCC() {
            var mancc = document.getElementById("mancc").value;
            var tenncc = document.getElementById("tenncc").value;
            var sdtncc = document.getElementById("sdtncc").value;
            var emailncc = document.getElementById("emailncc").value;
            var diachincc = document.getElementById("diachincc").value;
            var number = /^[0-9]+$/;

            if (mancc == null || mancc == "") {
                var d = new Date();
                mancc = Number(d);
            }
            if (tenncc == null || tenncc == "") {
                alert("Vui lòng thêm tên nhà cung cấp!");
                return false;
            }
            else if (!sdtncc.match(number) || sdtncc.length!=10) {
                alert("Vui lòng thêm số điện thoại nhà cung cấp có đủ 10 số!");
                return false;
            }
            else if (!(/^[^\s@]+@[^\s@]+\.[^\s@]+$/).test(emailncc)) {
                alert("email trống hoặc sai định dạng, vui lòng nhập lại!");
                return false;
            }
            else if (diachincc == null || diachincc == "") {
                alert("Vui lòng thêm địa chỉ nhà cung cấp!");
                return false;
            }
            else {
                for (var x of list) {
                    if (x.mancc == mancc) {
                        alert("Mã nhà cung cấp đã tồn tại! Vui lòng nhập lại!")
                        return false;
                    }
                }
            }
            // $scope.ApiThemSach(masach,mancc,tensach,gia,soluong,tacgia,bookcover);
            console.log('AddNCC');
            if (list == null) list = [];
            var supplier = {
                "mancc": mancc,
                "tenncc": tenncc,
                "sdtncc": sdtncc,
                "emailncc": emailncc,
                "diachincc": diachincc
            };
            list.push(supplier);
            localStorage.setItem("Supplier", JSON.stringify(list));
            alert("Đã thêm thành công!");
            location.reload();
        }
        function SuaNCC(mancc) {
            for (x of list) {
                if (x.mancc == mancc) {
                    document.getElementById("mancc").value = x.mancc;
                    document.getElementById("tenncc").value = x.tenncc;
                    document.getElementById("sdtncc").value = x.sdtncc;
                    document.getElementById("emailncc").value = x.emailncc;
                    document.getElementById("diachincc").value = x.diachincc;
                }
            }
        }
        function LoadData() {
            var str = "";
            var sl = 0;
            list.sort();
            for (x of list) {
                sl++;
                str += `
                        <tr>
                            <td class="le"><input type="checkbox" id="check" name="check_all"></td>
                            <td class="le">`+ x.mancc + `</td>
                            <td class="le">`+ x.tenncc + `</td>
                            <td class="le">`+ x.sdtncc + `</td>
                            <td class="le">`+ x.emailncc + `</td>
                            <td class="le">`+ x.diachincc + `</td>
                            <td class="le">
                                <!-- <i class="fa-solid fa-magnifying-glass"></i> -->
                                <i class="fa-regular fa-pen-to-square" title="Sửa" onclick="SuaNCC(`+ x.mancc + `)"></i>
                                <i class="fa-regular fa-trash-can" onclick="XoaNCC(`+ x.mancc + `)"></i>
                            </td>
                        </tr>
                    `;
            }
            document.getElementById("listCategorys").innerHTML = str;
            // $('#soluong').html(sl);
        }
        LoadData()
        function CapNhat() {
            var mancc = document.getElementById("mancc").value;
            var tenncc = document.getElementById("tenncc").value;
            var sdtncc = document.getElementById("sdtncc").value;
            var emailncc = document.getElementById("emailncc").value;
            var diachincc = document.getElementById("diachincc").value;
            var number = /^[0-9]+$/;
            var ok = true;

            if (mancc == null || mancc == "") {
                var d = new Date();
                mancc = Number(d);
            }
            else if (tenncc == null || tenncc == "") {
                alert("Vui lòng thêm tên loại sách!");
                return false;
            }
            else if (sdtncc == null || sdtncc == "") {
                alert("Vui lòng thêm mô tả loại sách!");
                return false;
            }
            else if (!sdtncc.match(number) || sdtncc.length!=10) {
                alert("Vui lòng thêm số điện thoại nhà cung cấp!");
                return false;
            }
            else if (emailncc != (/^[^\s@]+@[^\s@]+\.[^\s@]+$/)) {
                alert("email trống hoặc sai định dạng, vui lòng nhập lại!");
                return false;
            }
            else if (diachincc == null || diachincc == "") {
                alert("Vui lòng thêm địa chỉ nhà cung cấp!");
                return false;
            }
            for (x of list) {
                if (x.mancc == mancc) {
                    x.tenncc = tenncc;
                    x.sdtncc = sdtncc;
                    x.emailncc = emailncc;
                    ok = false;
                    break;
                }
            }

            if (ok == false) {
                alert("Cập nhật thông tin thành công!");
                localStorage.setItem("Supplier", JSON.stringify(list));
                location.reload();
            }
            else {
                alert("Cập nhật thông tin thất bại!");
            }
        }
        function XoaNCC(mancc) {
            if (confirm("Bạn chắc chắn muốn xóa!")) {
                var index = list.findIndex(x => x.mancc == mancc);
                if (index >= 0) {
                    list.splice(index, 1);
                }
                LoadData();
                localStorage.setItem('Product', JSON.stringify(list));
            }
        }
        function CheckAll(parent) {
            var ids = document.getElementsByTagName('input');
            for (var i = 0; i < ids.length; i++) {
                if (ids[i].name == "check_all") {
                    ids[i].checked = parent.checked;
                }
            }
        }
        function XoaNCCAll() {
            if (confirm("Bạn chắc chắn muốn xóa!")) {
                var checkall = document.getElementById('check');
                if (checkall.checked) {
                    localStorage.setItem('Product', JSON.stringify(null));
                }
                location.reload();
            }
        }
        // localStorage.removeItem("Product");
    </script>
    <!-- <script src="./home.js"></script> -->
</body>

</html>